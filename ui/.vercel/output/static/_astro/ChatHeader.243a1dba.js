import{r as o}from"./index.fa732fd6.js";import{G as f,j as e}from"./jsx-runtime.1db19270.js";function p(t){return f({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M872 394c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H400V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v236H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h228v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h164c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V394h164zM628 630H400V394h228v236z"}}]})(t)}function v({setSocket:t,socket:n,setMessages:r}){const[c,l]=o.useState(""),[a,d]=o.useState(!1);async function x(s){s.preventDefault();const h=new FormData(s.target),u=Object.fromEntries(h);let i=new WebSocket(`ws://localhost:3001/room/${u.room}/user/${u.username}`);i.onopen=()=>{console.log("connected"),t(i),d(!0)},i.onclose=()=>{console.log("disconnected"),t(null),d(!1)},i.onmessage=m=>{console.log("message received: ",m.data),r(b=>[...b,m.data])}}return e.jsx("form",{onSubmit:s=>{console.log("submitting: ",s),x(s)},children:e.jsxs("div",{className:"flex justify-between",children:[n?e.jsx("div",{className:"w-full mr-3",children:e.jsx("input",{onChange:s=>{s.preventDefault(),l(s.target.value)},value:c,type:"text",name:"message",id:"message",className:"block w-full rounded-md text-base px-2 py-2 border-custom-zinc dark:border-zinc-800 dark:bg-custom-black border shadow-sm placeholder:text-zinc-400 sm:leading-6",placeholder:"Start chatting!"})}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{children:e.jsx("input",{type:"name",name:"username",id:"username",className:"block w-full rounded-md text-base px-2 py-2 border-custom-zinc dark:border-zinc-800 dark:bg-custom-black border shadow-sm placeholder:text-zinc-400 sm:leading-6",placeholder:"Your username"})}),e.jsxs("div",{className:"relative w-28",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 pb-0.5 left-0 flex items-center pl-3",children:e.jsx(p,{className:"h-5 w-5 text-zinc-500","aria-hidden":"true"})}),e.jsx("input",{type:"number",name:"room",id:"room",className:"block w-full rounded-md border border-custom-zinc dark:border-zinc-800 dark:bg-custom-black placeholder:text-zinc-400 text-base pr-2 py-2 pl-10 text-custom-zinc dark:text-zinc-400 dark:ring-custom-white shadow-sm sm:leading-6",placeholder:"room"})]})]}),a?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:s=>{s.preventDefault(),n&&n.send(c),l("")},className:"rounded bg-green-500 px-2 py-1 text-base font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"Send"}),e.jsx("button",{onClick:s=>{s.preventDefault(),n&&n.close(),t(null)},className:"rounded bg-red-500 px-2 py-1 text-base font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"Disconnect"})]}):e.jsx("button",{type:"submit",className:"rounded bg-custom-black dark:bg-zinc-700 px-2 py-1 text-base font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"Connect"})]})})}function w(){const[t,n]=o.useState(null),[r,c]=o.useState([]);return e.jsxs("div",{className:"m-4 space-y-3 dark:text-zinc-400",children:[e.jsx("div",{className:"gap-2",children:e.jsx("div",{className:"flex w-full justify-between items-center gap-2",children:t?e.jsxs("div",{className:"flex justify-end w-full items-center",children:[e.jsx("div",{className:"flex-none rounded-full p-1 text-green-400 bg-green-400/10",children:e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-current"})}),"Online"]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg pl-0.5 font-medium leading-6 text-custom-zinc dark:text-zinc-300",children:"Enter a username, room number and click connect"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-none rounded-full p-1 text-red-400 bg-red-400/10",children:e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-current"})}),"Offline"]})]})})}),e.jsx(v,{setMessages:c,setSocket:n,socket:t}),e.jsx("div",{className:"mt-5 h-[450px] relative",children:e.jsx("pre",{className:"relative h-full text-custom-zinc dark:text-zinc-500 bg-zinc-50 dark:bg-zinc-200 p-4 overflow-y-scroll",children:t?e.jsx(e.Fragment,{children:r.map((l,a)=>l.startsWith("you just joined room: ")?e.jsx("p",{className:"text-green-500",children:l},a):e.jsx("p",{children:l},a))}):e.jsx("div",{children:"Please connect to a room to start chatting..."})})})]})}export{w as default};
